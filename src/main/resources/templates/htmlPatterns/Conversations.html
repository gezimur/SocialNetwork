<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>JugglersSocialNetwork</title>
    <link rel="stylesheet" type="text/css" href="css/maincss.css">
</head>
<body class="body">
<span class="blockWithLinks">
		<a href="/authorization">my profile</a><br>
		<a href="/conversations">conversations</a><br>
		<a href="/search">search</a><br>
		<a href="/help">help</a><br>
		<a href="/singOut">sing out</a><br>
	</span>
<p class="mainBlock">
		<span>
            <span class="name">Conversations</span>
		</span>
    <span class="bigBlock">
		<span id="textSpace" th:utext="${list_of_conv}"></span>
	</span>
</p>
<script>
	function deleteUserConv(e){
		var conversation = e.parentNode.previousSibling;
		var convId = conversation.href.substring(conversation.href.lastIndexOf("/") + 3)
		var form = new FormData();
		form.append("conversationId", convId);
		var url = '/deleteUserConversation';
		sendForm(form, url);
	}
	function addUserConv(e){
		var invited = e.previousSibling;
		var conversation = e.parentNode.previousSibling;
		var invitedName = invited.value;
		invited.value = "";
		var conversationName = conversation.innerText;
		var form = createMyForm(invitedName, conversationName);
		var url = '/addUserConversation';
		sendForm(form, url);
	}
	function sendForm(form, url){
		var req = new XMLHttpRequest();
		var response = "some problems";
		req.addEventListener('load', function(e){
			var data = e.target;
			response = data.responseText;
		});
		req.open('POST', url);
		req.responseType = 'text';
		req.send(form);
	}
	function createMyForm(invited, conversation){
		var form = new FormData();
		form.append("invited", invited);
		form.append("conversation", conversation);
		return form;
	}
</script>
</body>
</html>